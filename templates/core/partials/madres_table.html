<!-- Template parcial para la tabla de madres (usado por HTMX) -->
<div id="madres-table-container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3 class="card-header" style="margin-bottom: 0;">Listado de Madres (Administrativo)</h3>
        <div style="display: flex; gap: 0.5rem;">
            {% if puede_mostrar_mas %}
            <button 
               hx-get="{% url 'core:madres_table_htmx' %}?limite_madres={{ limite_actual|add:5 }}{% if busqueda_query %}&busqueda={{ busqueda_query }}{% endif %}"
               hx-target="#madres-table-container"
               hx-swap="outerHTML"
               hx-indicator=".htmx-loading"
               class="btn btn-success" 
               style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Mostrar más (+5)
            </button>
            {% endif %}
            
            {% if limite_actual|add:"0" > limite_inicial %}
            <button 
               hx-get="{% url 'core:madres_table_htmx' %}?limite_madres={{ limite_inicial }}{% if busqueda_query %}&busqueda={{ busqueda_query }}{% endif %}"
               hx-target="#madres-table-container"
               hx-swap="outerHTML"
               hx-indicator=".htmx-loading"
               class="btn" 
               style="background: #6b7280; color: white; display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Ver menos
            </button>
            {% endif %}
            
            <!-- Indicador de carga HTMX -->
            <div class="htmx-loading" style="display: none; color: #10b981; font-size: 14px; display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg class="animate-spin" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                </svg>
                Cargando...
            </div>
        </div>
    </div>
    
    <p style="color: var(--gray-600); font-size: 14px; margin-bottom: 1rem;">
        Mostrando {{ lista_madres_administrativa|length }} de {{ total_madres_admin }} madres
    </p>
    
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>RUT</th>
                    <th>Nombre Completo</th>
                    <th>Ficha Clínica</th>
                    <th>Fecha Nacimiento</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for madre in lista_madres_administrativa %}
                <tr>
                    <td>{{ madre.rut_descifrado }}</td>
                    <td style="font-weight: 600;">{{ madre.nombre_descifrado }}</td>
                    <td>{{ madre.ficha_clinica_numero|default:"Sin ficha" }}</td>
                    <td>{{ madre.fecha_nacimiento|date:"d/m/Y" }}</td>
                    <td>
                        {% if user.puede_editar_admision_madre %}
                        <a href="{% url 'core:madre_update' madre.pk %}" 
                           class="btn-icon" 
                           style="background: #3b82f6; color: white;" 
                           title="Editar">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                            </svg>
                        </a>
                        {% endif %}
                        {% if user.puede_anexar_correccion %}
                        <a href="{% url 'core:anexar_correccion_madre' madre.pk %}" 
                           class="btn-icon" 
                           style="background: #f59e0b; color: white;" 
                           title="Anexar Corrección Madre">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                            </svg>
                        </a>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" style="text-align: center;">
                        No hay madres registradas.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
