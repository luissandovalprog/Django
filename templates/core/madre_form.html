{% extends 'base.html' %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="form-container" style="max-width: 900px; margin: 0 auto;">
    <div class="card">
        <h2 class="card-header">Admisión de Madre</h2>

        <form method="post">
            {% csrf_token %}

            {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {% for error in form.non_field_errors %}
                <p>{{ error }}</p>
                {% endfor %}
            </div>
            {% endif %}

            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.rut.id_for_label }}" class="form-label required">RUT</label>
                    <input type="text" ... class="form-input" ... required
                           id="{{ form.rut.id_for_label }}" 
                           name="{{ form.rut.name }}"
                           class="form-input" 
                           placeholder="12.345.678-9"
                           value="{{ form.rut.value|default:'' }}">
                    {% if form.rut.errors %}
                        <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.rut.errors|join:", " }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.nombre.id_for_label }}" class="form-label required">Nombre Completo</label>
                    <input type="text" ... class="form-input" ... required
                           id="{{ form.nombre.id_for_label }}" 
                           name="{{ form.nombre.name }}"
                           class="form-input" 
                           placeholder="Nombre completo de la paciente"
                           value="{{ form.nombre.value|default:'' }}">
                    {% if form.nombre.errors %}
                        <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.nombre.errors|join:", " }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.fecha_nacimiento.id_for_label }}" class="form-label required">Fecha de Nacimiento</label>
                    <input type="date" ... class="form-input" ... required
                           id="{{ form.fecha_nacimiento.id_for_label }}" 
                           name="{{ form.fecha_nacimiento.name }}"
                           class="form-input"
                           value="{{ form.fecha_nacimiento.value|default:'' }}">
                    {% if form.fecha_nacimiento.errors %}
                        <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.fecha_nacimiento.errors|join:", " }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="edad" class="form-label">Edad</label>
                    <input type="number" ... class="form-input" ... readonly
                           id="edad"
                           class="form-input" 
                           placeholder="Edad en años"
                           readonly
                           style="background: var(--gray-100);">
                </div>

                <div class="form-group">
                    <label for="{{ form.nacionalidad.id_for_label }}" class="form-label required">Nacionalidad</label>
                    <select id="{{ form.nacionalidad.id_for_label }}" ... class="form-select" ... required
                            name="{{ form.nacionalidad.name }}"
                            class="form-select">
                        <option value="Chilena">Chilena</option>
                        <option value="Extranjera">Extranjera</option>
                    </select>
                    {% if form.nacionalidad.errors %}
                        <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.nacionalidad.errors|join:", " }}</p>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label class="form-label">¿Pertenece a pueblo originario?</label>
                    <div class="form-checkbox">
                        <input type="checkbox" 
                               id="{{ form.pertenece_pueblo_originario.id_for_label }}" 
                               name="{{ form.pertenece_pueblo_originario.name }}"
                               {% if form.pertenece_pueblo_originario.value %}checked{% endif %}>
                        <label for="{{ form.pertenece_pueblo_originario.id_for_label }}">Sí, pertenece a pueblo originario</label>
                    </div>
                    <p class="form-hint">Para estadísticas REM</p>
                </div>
            </div>

            <div class="form-group">
                <label for="{{ form.ficha_clinica_numero.id_for_label }}" class="form-label">
                    Número de Ficha Clínica
                    <span style="font-size: 12px; color: var(--gray-500); font-weight: 400;">(Generado automáticamente)</span>
                </label>
                <input type="text" 
                    id="{{ form.ficha_clinica_numero.id_for_label }}" 
                    name="{{ form.ficha_clinica_numero.name }}"
                    class="form-input" 
                    value="{{ form.ficha_clinica_numero.value|default:'' }}"
                    readonly
                    style="background-color: #f3f4f6; cursor: not-allowed;">
                <p class="form-hint">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    Este número se genera automáticamente al registrar la madre
                </p>
                {% if form.ficha_clinica_numero.errors %}
                    <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.ficha_clinica_numero.errors|join:", " }}</p>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.direccion.id_for_label }}" class="form-label">Dirección de Residencia</label>
                <input type="text" ... class="form-input" ... required
                    id="{{ form.direccion.id_for_label }}" 
                    name="{{ form.direccion.name }}"
                    class="form-input" 
                    placeholder="Dirección completa"
                    value="{{ form.direccion.value|default:'' }}">
                {% if form.direccion.errors %}
                    <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.direccion.errors|join:", " }}</p>
                {% endif %}
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.telefono.id_for_label }}" class="form-label">Teléfono de Contacto</label>
                    <input type="tel" ... class="form-input" ... required
                           id="{{ form.telefono.id_for_label }}" 
                           name="{{ form.telefono.name }}"
                           class="form-input" 
                           placeholder="+56 9 1234 5678"
                           value="{{ form.telefono.value|default:'' }}">
                </div>

                <div class="form-group">
                    <label for="{{ form.prevision.id_for_label }}" class="form-label">Previsión de Salud</label>
                    <select id="{{ form.prevision.id_for_label }}" ... class="form-select" ... required
                            name="{{ form.prevision.name }}"
                            class="form-select">
                        <option value="">Seleccione...</option>
                        <option value="FONASA">FONASA A</option>
                        <option value="ISAPRE">ISAPRE</option>
                        <option value="PARTICULAR">Particular</option>
                        <option value="NINGUNA">Ninguna</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="{{ form.antecedentes_medicos.id_for_label }}" class="form-label">Antecedentes Médicos</label>
                <textarea id="{{ form.antecedentes_medicos.id_for_label }}" ... class="form-textarea" ... required
                          name="{{ form.antecedentes_medicos.name }}"
                          class="form-textarea" 
                          placeholder="Ingrese antecedentes médicos relevantes">{{ form.antecedentes_medicos.value|default:'' }}</textarea>
                {% if form.antecedentes_medicos.errors %}
                    <p style="color: var(--primary-red); font-size: 13px; margin-top: 4px;">{{ form.antecedentes_medicos.errors|join:", " }}</p>
                {% endif %}
            </div>

            <div class="btn-group">
                <a href="{% url 'core:dashboard' %}" class="btn btn-secondary">
                    Cancelar
                </a>
                <button type="submit" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <polyline points="17 21 17 13 7 13 7 21"/>
                        <polyline points="7 3 7 8 15 8"/>
                    </svg>
                    Registrar Madre
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}